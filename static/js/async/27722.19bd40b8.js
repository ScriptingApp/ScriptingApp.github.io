"use strict";(self.rspackChunktest=self.rspackChunktest||[]).push([["27722"],{64017(e,s,n){n.r(s),n.d(s,{default:()=>l});var r=n(74848),i=n(28453);function o(e){let s={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"WebSocket"})," 类提供了创建和管理 WebSocket 连接的接口，允许与服务器进行实时通信。你可以通过 WebSocket 连接发送和接收文本和二进制数据，包括字节缓冲区。"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"概述",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#概述",children:"#"}),"概述"]}),"\n",(0,r.jsx)(s.p,{children:"WebSocket 是一种通信协议，允许客户端与服务器之间进行全双工通信。这使其非常适用于实时应用程序，如即时消息、通知或数据流。"}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"类websocket",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#类websocket",children:"#"}),"类：",(0,r.jsx)(s.code,{children:"WebSocket"})]}),"\n",(0,r.jsxs)(s.h3,{id:"构造函数",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#构造函数",children:"#"}),"构造函数"]}),"\n",(0,r.jsxs)(s.h4,{id:"new-websocketurl-string",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#new-websocketurl-string",children:"#"}),(0,r.jsx)(s.code,{children:"new WebSocket(url: string)"})]}),"\n",(0,r.jsx)(s.p,{children:"创建一个新的 WebSocket 连接到指定的 URL，并立即尝试建立连接。"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"参数"}),"："]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"url: string"}),"：要连接的 WebSocket 服务器 URL。示例：",(0,r.jsx)(s.code,{children:'"ws://example.com/socket"'})," 或 ",(0,r.jsx)(s.code,{children:'"wss://example.com/socket"'}),"（对于安全的 WebSocket 连接）。"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"返回"}),"：一个表示连接的 ",(0,r.jsx)(s.code,{children:"WebSocket"})," 对象。"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h3,{id:"属性",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#属性",children:"#"}),"属性"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"url: string"})}),(0,r.jsx)(s.br,{}),"\nWebSocket 连接的 URL。此属性为只读。"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"onopen?: () => void"})}),(0,r.jsx)(s.br,{}),"\n可选的回调函数，当 WebSocket 连接成功建立时触发。"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"onerror?: (error: Error) => void"})}),(0,r.jsx)(s.br,{}),"\n可选的回调函数，当 WebSocket 连接或通信发生错误时触发。"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"onmessage?: (message: string | Data) => void"})}),(0,r.jsx)(s.br,{}),"\n可选的回调函数，当从 WebSocket 服务器接收到消息时触发。",(0,r.jsx)(s.code,{children:"message"})," 参数可以是字符串或二进制数据（由 ",(0,r.jsx)(s.code,{children:"Data"})," 类表示）。"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"onclose?: (reason?: string) => void"})}),(0,r.jsx)(s.br,{}),"\n可选的回调函数，当 WebSocket 连接关闭时触发。",(0,r.jsx)(s.code,{children:"reason"})," 参数提供了关闭连接的可选解释。"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h3,{id:"方法",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#方法",children:"#"}),"方法"]}),"\n",(0,r.jsxs)(s.h4,{id:"sendmessage-string--data-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#sendmessage-string--data-void",children:"#"}),(0,r.jsx)(s.code,{children:"send(message: string | Data): void"})]}),"\n",(0,r.jsx)(s.p,{children:"通过 WebSocket 连接向服务器发送数据。"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"参数"}),"："]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"message: string | Data"}),"：要发送到服务器的数据。可以是字符串或 ",(0,r.jsx)(s.code,{children:"Data"})," 类的实例。"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"返回"}),"：",(0,r.jsx)(s.code,{children:"void"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"closecode-1000--1001--1002--1003-reason-string-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#closecode-1000--1001--1002--1003-reason-string-void",children:"#"}),(0,r.jsx)(s.code,{children:"close(code?: 1000 | 1001 | 1002 | 1003, reason?: string): void"})]}),"\n",(0,r.jsx)(s.p,{children:"关闭 WebSocket 连接。如果连接已经关闭，则此方法不执行任何操作。"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"参数"}),"："]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"code?: 1000 | 1001 | 1002 | 1003"}),"：可选的 WebSocket 连接关闭代码。常见的代码包括：\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"1000"}),"：正常关闭"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"1001"}),"：离开"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"1002"}),"：协议错误"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"1003"}),"：不支持的数据类型"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"reason?: string"}),"：可选的关闭连接原因。此字符串的长度不得超过 123 字节（UTF-8 编码）。"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"返回"}),"：",(0,r.jsx)(s.code,{children:"void"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h3,{id:"事件处理",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#事件处理",children:"#"}),"事件处理"]}),"\n",(0,r.jsxs)(s.p,{children:["你可以使用 ",(0,r.jsx)(s.code,{children:"addEventListener"})," 来监听 WebSocket 事件，并使用 ",(0,r.jsx)(s.code,{children:"removeEventListener"})," 来移除事件监听器。"]}),"\n",(0,r.jsxs)(s.h4,{id:"addeventlistenerevent-open-listener---void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#addeventlistenerevent-open-listener---void-void",children:"#"}),(0,r.jsx)(s.code,{children:'addEventListener(event: "open", listener: () => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["为 ",(0,r.jsx)(s.code,{children:'"open"'})," 事件添加事件监听器，该事件在 WebSocket 连接建立时触发。"]}),"\n",(0,r.jsxs)(s.h4,{id:"addeventlistenerevent-error-listener-error-error--void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#addeventlistenerevent-error-listener-error-error--void-void",children:"#"}),(0,r.jsx)(s.code,{children:'addEventListener(event: "error", listener: (error: Error) => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["为 ",(0,r.jsx)(s.code,{children:'"error"'})," 事件添加事件监听器，该事件在 WebSocket 连接发生错误时触发。"]}),"\n",(0,r.jsxs)(s.h4,{id:"addeventlistenerevent-message-listener-message-string--data--void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#addeventlistenerevent-message-listener-message-string--data--void-void",children:"#"}),(0,r.jsx)(s.code,{children:'addEventListener(event: "message", listener: (message: string | Data) => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["为 ",(0,r.jsx)(s.code,{children:'"message"'})," 事件添加事件监听器，该事件在从 WebSocket 服务器接收到消息时触发。"]}),"\n",(0,r.jsxs)(s.h4,{id:"addeventlistenerevent-close-listener-reason-string--void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#addeventlistenerevent-close-listener-reason-string--void-void",children:"#"}),(0,r.jsx)(s.code,{children:'addEventListener(event: "close", listener: (reason?: string) => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["为 ",(0,r.jsx)(s.code,{children:'"close"'})," 事件添加事件监听器，该事件在 WebSocket 连接关闭时触发。"]}),"\n",(0,r.jsxs)(s.h4,{id:"removeeventlistenerevent-open-listener---void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#removeeventlistenerevent-open-listener---void-void",children:"#"}),(0,r.jsx)(s.code,{children:'removeEventListener(event: "open", listener: () => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["移除 ",(0,r.jsx)(s.code,{children:'"open"'})," 事件的事件监听器。"]}),"\n",(0,r.jsxs)(s.h4,{id:"removeeventlistenerevent-error-listener-error-error--void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#removeeventlistenerevent-error-listener-error-error--void-void",children:"#"}),(0,r.jsx)(s.code,{children:'removeEventListener(event: "error", listener: (error: Error) => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["移除 ",(0,r.jsx)(s.code,{children:'"error"'})," 事件的事件监听器。"]}),"\n",(0,r.jsxs)(s.h4,{id:"removeeventlistenerevent-message-listener-message-string--data--void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#removeeventlistenerevent-message-listener-message-string--data--void-void",children:"#"}),(0,r.jsx)(s.code,{children:'removeEventListener(event: "message", listener: (message: string | Data) => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["移除 ",(0,r.jsx)(s.code,{children:'"message"'})," 事件的事件监听器。"]}),"\n",(0,r.jsxs)(s.h4,{id:"removeeventlistenerevent-close-listener-reason-string--void-void",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#removeeventlistenerevent-close-listener-reason-string--void-void",children:"#"}),(0,r.jsx)(s.code,{children:'removeEventListener(event: "close", listener: (reason?: string) => void): void'})]}),"\n",(0,r.jsxs)(s.p,{children:["移除 ",(0,r.jsx)(s.code,{children:'"close"'})," 事件的事件监听器。"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"示例使用",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#示例使用",children:"#"}),"示例使用"]}),"\n",(0,r.jsxs)(s.h3,{id:"建立-websocket-连接",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#建立-websocket-连接",children:"#"}),"建立 WebSocket 连接"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocket"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"wss://example.com/socket"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// 设置事件监听器"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"open"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"连接已建立！"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".send"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"你好，服务器！"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"message"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (message) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"接收到消息："'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" message)"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"error"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (error) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"WebSocket 错误："'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" error)"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"close"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (reason) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"连接已关闭："'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" reason)"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"发送字符串消息",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#发送字符串消息",children:"#"}),"发送字符串消息"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocket"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"wss://example.com/socket"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"open"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".send"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"你好，这是测试消息！"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"使用-data-发送二进制数据",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#使用-data-发送二进制数据",children:"#"}),"使用 ",(0,r.jsx)(s.code,{children:"Data"})," 发送二进制数据"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocket"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"wss://example.com/socket"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"open"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"  const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" data"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" Data"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".fromString"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"一些消息"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".send"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(data) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// 发送二进制数据"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"处理二进制数据",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#处理二进制数据",children:"#"}),"处理二进制数据"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocket"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"wss://example.com/socket"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"message"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (message) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"  if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (message "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"instanceof"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" Data"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:") {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"    const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" byteArray"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" message"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".getBytes"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"    if"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (byteArray) {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"      console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"接收到的二进制数据："'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" byteArray)"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"关闭-websocket-连接",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#关闭-websocket-连接",children:"#"}),"关闭 WebSocket 连接"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocket"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"wss://example.com/socket"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addEventListener"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"open"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"连接已建立！"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"  // 使用自定义原因关闭连接"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"  ws"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".close"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1000"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "测试后关闭连接"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"注意事项",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#注意事项",children:"#"}),"注意事项"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"send()"})," 方法可以处理文本和二进制数据。对于二进制数据，你可以使用 ",(0,r.jsx)(s.code,{children:"Data"})," 类来处理字节缓冲区。"]}),"\n",(0,r.jsxs)(s.li,{children:["对于二进制数据，请确保你的 WebSocket 服务器能够处理二进制数据，例如 ",(0,r.jsx)(s.code,{children:"ArrayBuffer"})," 或 ",(0,r.jsx)(s.code,{children:"Uint8Array"}),"。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"close()"})," 方法可以接受 ",(0,r.jsx)(s.code,{children:"code"})," 和可选的 ",(0,r.jsx)(s.code,{children:"reason"})," 参数来指定 WebSocket 连接如何关闭。"]}),"\n"]})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["zh%2Fguide%2FUtilities%2FWebScoket.md"]={toc:[{id:"概述",text:"概述",depth:2},{id:"类websocket",text:"类：`WebSocket`",depth:2},{id:"构造函数",text:"构造函数",depth:3},{id:"new-websocketurl-string",text:"`new WebSocket(url: string)`",depth:4},{id:"属性",text:"属性",depth:3},{id:"方法",text:"方法",depth:3},{id:"sendmessage-string--data-void",text:"`send(message: string | Data): void`",depth:4},{id:"closecode-1000--1001--1002--1003-reason-string-void",text:"`close(code?: 1000 | 1001 | 1002 | 1003, reason?: string): void`",depth:4},{id:"事件处理",text:"事件处理",depth:3},{id:"addeventlistenerevent-open-listener---void-void",text:'`addEventListener(event: "open", listener: () => void): void`',depth:4},{id:"addeventlistenerevent-error-listener-error-error--void-void",text:'`addEventListener(event: "error", listener: (error: Error) => void): void`',depth:4},{id:"addeventlistenerevent-message-listener-message-string--data--void-void",text:'`addEventListener(event: "message", listener: (message: string | Data) => void): void`',depth:4},{id:"addeventlistenerevent-close-listener-reason-string--void-void",text:'`addEventListener(event: "close", listener: (reason?: string) => void): void`',depth:4},{id:"removeeventlistenerevent-open-listener---void-void",text:'`removeEventListener(event: "open", listener: () => void): void`',depth:4},{id:"removeeventlistenerevent-error-listener-error-error--void-void",text:'`removeEventListener(event: "error", listener: (error: Error) => void): void`',depth:4},{id:"removeeventlistenerevent-message-listener-message-string--data--void-void",text:'`removeEventListener(event: "message", listener: (message: string | Data) => void): void`',depth:4},{id:"removeeventlistenerevent-close-listener-reason-string--void-void",text:'`removeEventListener(event: "close", listener: (reason?: string) => void): void`',depth:4},{id:"示例使用",text:"示例使用",depth:2},{id:"建立-websocket-连接",text:"建立 WebSocket 连接",depth:3},{id:"发送字符串消息",text:"发送字符串消息",depth:3},{id:"使用-data-发送二进制数据",text:"使用 `Data` 发送二进制数据",depth:3},{id:"处理二进制数据",text:"处理二进制数据",depth:3},{id:"关闭-websocket-连接",text:"关闭 WebSocket 连接",depth:3},{id:"注意事项",text:"注意事项",depth:2}],title:"WebScoket",headingTitle:"",frontmatter:{title:"WebScoket",description:"该接口允许你创建和管理 WebSocket 连接的接口，与服务器进行实时通信。"}}}}]);