"use strict";(self.rspackChunktest=self.rspackChunktest||[]).push([["51942"],{3685(e,s,n){n.r(s),n.d(s,{default:()=>o});var i=n(74848),r=n(28453);function t(e){let s={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.p,{children:["AssistantTool is an extensible tool mechanism in ",(0,i.jsx)(s.strong,{children:"Scripting"})," that provides system-level capabilities to the Assistant. By defining and implementing Assistant Tools, script authors can expose structured functionality—such as device access, file manipulation, and data processing—that the Assistant can invoke during a conversation and then continue reasoning based on the execution result."]}),"\n",(0,i.jsx)(s.p,{children:"The design of AssistantTool focuses on two core goals:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Granting the Assistant additional capabilities while maintaining strong control and transparency, especially for sensitive operations that require explicit user approval."}),"\n",(0,i.jsx)(s.li,{children:"Providing clear inputs, clear outputs, and testability, so tools can be reasoned about, validated, and safely composed by the Assistant."}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"types-of-assistanttools",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#types-of-assistanttools",children:"#"}),"Types of AssistantTools"]}),"\n",(0,i.jsx)(s.p,{children:"From an execution model perspective, AssistantTool has two primary types, corresponding to two different registration APIs."}),"\n",(0,i.jsxs)(s.h3,{id:"tools-without-user-approval",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#tools-without-user-approval",children:"#"}),"Tools Without User Approval"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"assistant_tool.json"}),": ",(0,i.jsx)(s.code,{children:"requireApproval: false"})]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Code registration:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"AssistantTool.registerExecuteTool<P>(executeFn)"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Typical use cases include:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Pure computation or data transformation"}),"\n",(0,i.jsx)(s.li,{children:"Formatting, parsing, or code generation"}),"\n",(0,i.jsx)(s.li,{children:"Non-sensitive operations that do not access device permissions or private user data"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"In this mode, the tool is executed immediately once the Assistant decides to invoke it."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h3,{id:"tools-with-user-approval",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#tools-with-user-approval",children:"#"}),"Tools With User Approval"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"assistant_tool.json"}),": ",(0,i.jsx)(s.code,{children:"requireApproval: true"})]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Code registration:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"AssistantTool.registerApprovalRequest<P>(requestFn)"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"AssistantTool.registerExecuteToolWithApproval<P>(executeFn)"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Typical use cases include:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Accessing privacy-sensitive resources (location, photos, contacts, calendar, etc.)"}),"\n",(0,i.jsx)(s.li,{children:"Modifying user data or project files"}),"\n",(0,i.jsx)(s.li,{children:"Any operation where the user should explicitly understand and confirm what will happen"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Optionally, tools can provide a preview action that allows the user to inspect the expected outcome before approving execution."}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"autoApprove"})," flag determines ",(0,i.jsx)(s.strong,{children:"whether this specific tool is allowed to be auto-approved"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"script-editor-only-tools",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#script-editor-only-tools",children:"#"}),"Script-Editor-Only Tools"]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"scriptEditorOnly"})," field in ",(0,i.jsx)(s.code,{children:"assistant_tool.json"})," determines whether a tool can only be used inside the script editor."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"scriptEditorOnly: false"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"The tool may be invoked in regular Assistant conversations."}),"\n",(0,i.jsxs)(s.li,{children:["A ",(0,i.jsx)(s.code,{children:"ScriptEditorProvider"})," instance is usually not available."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"scriptEditorOnly: true"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"The tool is restricted to the script editor context."}),"\n",(0,i.jsxs)(s.li,{children:["Execution functions receive an additional ",(0,i.jsx)(s.code,{children:"scriptEditorProvider?: ScriptEditorProvider"})," parameter."]}),"\n",(0,i.jsx)(s.li,{children:"Intended for editor-centric tools such as code formatting, batch file edits, diff previews, or lint-driven refactors."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"tool-creation-and-file-structure",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#tool-creation-and-file-structure",children:"#"}),"Tool Creation and File Structure"]}),"\n",(0,i.jsx)(s.p,{children:"When an AssistantTool is created, the system generates two files:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"assistant_tool.json"}),"\nDeclares the tool’s metadata, parameters, and execution constraints."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"assistant_tool.tsx"}),"\nContains the implementation logic and registers the tool using the AssistantTool APIs."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.h3,{id:"responsibility-of-assistant_tooljson",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#responsibility-of-assistant_tooljson",children:"#"}),"Responsibility of ",(0,i.jsx)(s.code,{children:"assistant_tool.json"})]}),"\n",(0,i.jsx)(s.p,{children:"The configuration file is responsible for:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"UI presentation (displayName, icon, color, description)"}),"\n",(0,i.jsxs)(s.li,{children:["Tool routing (unique ",(0,i.jsx)(s.code,{children:"id"}),")"]}),"\n",(0,i.jsx)(s.li,{children:"Invocation constraints (parameters, requireApproval, autoApprove, scriptEditorOnly)"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Execution logic is never implemented in this file and always lives in ",(0,i.jsx)(s.code,{children:"assistant_tool.tsx"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"parameters-and-input-mapping",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#parameters-and-input-mapping",children:"#"}),"Parameters and Input Mapping"]}),"\n",(0,i.jsxs)(s.p,{children:["Tool input parameters are defined in ",(0,i.jsx)(s.code,{children:"assistant_tool.json"})," and are passed into execution functions as a typed ",(0,i.jsx)(s.code,{children:"params"})," object."]}),"\n",(0,i.jsx)(s.p,{children:"These parameters are provided to:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"AssistantToolApprovalRequestFn<P>(params, scriptEditorProvider?)"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"AssistantToolExecuteWithApprovalFn<P>(params, userAction, scriptEditorProvider?)"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"AssistantToolExecuteFn<P>(params, scriptEditorProvider?)"})}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Key conventions:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"P"})," is a TypeScript type declared in ",(0,i.jsx)(s.code,{children:"assistant_tool.tsx"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["The runtime maps JSON parameters into the ",(0,i.jsx)(s.code,{children:"params"})," object."]}),"\n",(0,i.jsxs)(s.li,{children:["Tools without parameters typically use ",(0,i.jsx)(s.code,{children:"P = {}"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"runtime-execution-flow",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#runtime-execution-flow",children:"#"}),"Runtime Execution Flow"]}),"\n",(0,i.jsx)(s.p,{children:"From a runtime perspective, a complete tool invocation follows one of the flows below."}),"\n",(0,i.jsxs)(s.h3,{id:"approval-required-flow",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#approval-required-flow",children:"#"}),"Approval-Required Flow"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["The Assistant selects a tool and constructs ",(0,i.jsx)(s.code,{children:"params"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"The system invokes the registered approval request function."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"The approval request returns:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"A message shown to the user"}),"\n",(0,i.jsx)(s.li,{children:"Optional title"}),"\n",(0,i.jsx)(s.li,{children:"Optional preview button"}),"\n",(0,i.jsx)(s.li,{children:"Optional primary and secondary button labels"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["The user’s selection is captured as ",(0,i.jsx)(s.code,{children:"UserActionForApprovalRequest"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["The system invokes the execution function registered via ",(0,i.jsx)(s.code,{children:"registerExecuteToolWithApproval"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["The execution function returns ",(0,i.jsx)(s.code,{children:"{ success, message }"})," to the Assistant."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h3,{id:"no-approval-flow",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#no-approval-flow",children:"#"}),"No-Approval Flow"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["The Assistant selects a tool and constructs ",(0,i.jsx)(s.code,{children:"params"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["The system directly invokes the execution function registered via ",(0,i.jsx)(s.code,{children:"registerExecuteTool"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["The execution function returns ",(0,i.jsx)(s.code,{children:"{ success, message }"})," to the Assistant."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"tool-output-contract",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#tool-output-contract",children:"#"}),"Tool Output Contract"]}),"\n",(0,i.jsx)(s.p,{children:"All execution functions return a uniform result structure:"}),"\n",(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,i.jsxs)(s.code,{children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  success"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" boolean"})]}),"\n",(0,i.jsxs)(s.span,{className:"line",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  message"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string"})]}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"message"})," field is treated as structured output consumable by the Assistant. Recommended patterns include:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Natural language summaries for simple results"}),"\n",(0,i.jsx)(s.li,{children:"Lightweight markup for structured data"}),"\n",(0,i.jsx)(s.li,{children:"Multi-line output where the first line is a summary and subsequent lines provide details"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Returning excessively large raw data is discouraged. For editor-related tools, previews and diffs should be surfaced through UI mechanisms instead."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"test-functions",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#test-functions",children:"#"}),"Test Functions"]}),"\n",(0,i.jsx)(s.p,{children:"Each registration API returns a corresponding test function for use inside the script editor:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Approval request registration → approval request test function"}),"\n",(0,i.jsx)(s.li,{children:"Execution with approval registration → execution test function with user action"}),"\n",(0,i.jsx)(s.li,{children:"Execution without approval registration → execution test function"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"These functions allow developers to:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Validate parameter mapping"}),"\n",(0,i.jsx)(s.li,{children:"Verify execution logic and output"}),"\n",(0,i.jsx)(s.li,{children:"Debug tools without relying on an actual Assistant conversation"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"progress-reporting",children:[(0,i.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#progress-reporting",children:"#"}),"Progress Reporting"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"AssistantTool.report(message: string, id?: string)"})," can be used to emit progress updates while a tool is running. The parameter ",(0,i.jsx)(s.code,{children:"id"})," can be used to update an existing report."]}),"\n",(0,i.jsx)(s.p,{children:"Typical use cases include:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Long-running operations"}),"\n",(0,i.jsx)(s.li,{children:"Multi-step processes"}),"\n",(0,i.jsx)(s.li,{children:"Debugging and observability"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Progress messages should be meaningful and not emitted excessively."})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["TestFlight%2Fen%2Fguide%2FAssistantTool%2FOverview%20and%20Workflow.md"]={toc:[{id:"types-of-assistanttools",text:"Types of AssistantTools",depth:2},{id:"tools-without-user-approval",text:"Tools Without User Approval",depth:3},{id:"tools-with-user-approval",text:"Tools With User Approval",depth:3},{id:"script-editor-only-tools",text:"Script-Editor-Only Tools",depth:2},{id:"tool-creation-and-file-structure",text:"Tool Creation and File Structure",depth:2},{id:"responsibility-of-assistant_tooljson",text:"Responsibility of `assistant_tool.json`",depth:3},{id:"parameters-and-input-mapping",text:"Parameters and Input Mapping",depth:2},{id:"runtime-execution-flow",text:"Runtime Execution Flow",depth:2},{id:"approval-required-flow",text:"Approval-Required Flow",depth:3},{id:"no-approval-flow",text:"No-Approval Flow",depth:3},{id:"tool-output-contract",text:"Tool Output Contract",depth:2},{id:"test-functions",text:"Test Functions",depth:2},{id:"progress-reporting",text:"Progress Reporting",depth:2}],title:"Overview and Workflow",headingTitle:"",frontmatter:{title:"Overview and Workflow",description:"Learn about the overview and workflow of AssistantTools.",tag:"PRO"}}}}]);