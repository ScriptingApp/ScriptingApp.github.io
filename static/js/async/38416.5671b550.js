"use strict";(self.rspackChunktest=self.rspackChunktest||[]).push([["38416"],{67667(n,e,s){s.r(e),s.d(e,{default:()=>a});var r=s(74848),o=s(28453);function i(n){let e={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"Scriptingâ€™s UI rendering system and the vast majority of JavaScript execution run on the main thread by default. In normal usage, developers rarely need to manually switch threads."}),"\n",(0,r.jsxs)(e.p,{children:["However, some system APIs or internal operations may occasionally execute on a background thread. To ensure UI updates are always safe, and to support running heavy work without blocking the main thread, Scripting provides the global ",(0,r.jsx)(e.code,{children:"Thread"})," API."]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"Thread"})," is a global namespace and does not require imports."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"threadismainthread-boolean",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#threadismainthread-boolean",children:"#"}),(0,r.jsx)(e.code,{children:"Thread.isMainThread: boolean"})]}),"\n",(0,r.jsx)(e.p,{children:"Indicates whether the current JavaScript execution context is running on the main thread."}),"\n",(0,r.jsxs)(e.p,{children:["Most of the time this value is ",(0,r.jsx)(e.code,{children:"true"}),", but certain system callbacks or asynchronous operations may occur on background threads. When performing UI updates, this property can be used to confirm that the current thread is safe for UI operations."]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ("}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Thread"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".isMainThread) {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'On main thread'"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'On background thread'"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"threadruninmainexecute---void-void",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#threadruninmainexecute---void-void",children:"#"}),(0,r.jsx)(e.code,{children:"Thread.runInMain(execute: () => void): void"})]}),"\n",(0,r.jsx)(e.p,{children:"Executes the given function on the main thread."}),"\n",(0,r.jsx)(e.p,{children:"Because JavaScript normally runs on the main thread, you usually do not need to call this method explicitly. It is mainly useful when:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"A system API callback happens on a background thread and you need to update the UI"}),"\n",(0,r.jsx)(e.li,{children:"You want to strictly ensure that a specific piece of logic runs on the main thread"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"This method does not return a value and does not switch back to the previous thread. It simply guarantees synchronous execution on the main thread."}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Thread"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".runInMain"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(() "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"  title"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".value "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'Updated on main thread'"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"threadruninbackgroundtexecute---t--promiset-promiset",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#threadruninbackgroundtexecute---t--promiset-promiset",children:"#"}),(0,r.jsx)(e.code,{children:"Thread.runInBackground<T>(execute: () => T | Promise<T>): Promise<T>"})]}),"\n",(0,r.jsx)(e.p,{children:"Runs the provided function on a background thread and returns its result as a Promise.\nOnce the background task completes, the result is delivered back on the thread that initiated the call (typically the main thread)."}),"\n",(0,r.jsx)(e.p,{children:"This is ideal for:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"CPU-intensive tasks"}),"\n",(0,r.jsx)(e.li,{children:"Large data processing"}),"\n",(0,r.jsx)(e.li,{children:"Any work that should not block the UI"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"The function may return either a value or a Promise."}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" total"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" Thread"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".runInBackground"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(() "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"  let"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" v "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" 0"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"  for"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ("}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" i "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" 0"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"; i "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" 5_000_000"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"; i"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"++"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") v "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"+="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" i"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" v"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Computed result:'"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" total)"})]})]})})}),"\n",(0,r.jsx)(e.p,{children:"Async example:"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" filtered"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" Thread"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".runInBackground"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"async"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"  const"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" image"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" loadImage"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" applyFilter"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(image)"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Thread"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".runInMain"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(() "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  setImage"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(filtered)"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"automatic-thread-switching-in-asynchronous-io",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#automatic-thread-switching-in-asynchronous-io",children:"#"}),"Automatic Thread Switching in Asynchronous I/O"]}),"\n",(0,r.jsxs)(e.p,{children:["Many ",(0,r.jsx)(e.strong,{children:"asynchronous I/O methods in Scripting already run on background threads automatically"}),", so developers do ",(0,r.jsx)(e.strong,{children:"not"})," need to manually call ",(0,r.jsx)(e.code,{children:"runInBackground"})," for them."]}),"\n",(0,r.jsx)(e.p,{children:"Example:"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(e.code,{children:(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" text"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" FileManager"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".readAsString"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(path)"})]})})})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"readAsString"})," automatically performs file reading on a background thread, then returns the result back on the thread where the call was made (usually the main thread)."]}),"\n",(0,r.jsxs)(e.p,{children:["This means asynchronous I/O will ",(0,r.jsx)(e.strong,{children:"not"})," block the UI, even if you call them directly in your UI logic."]}),"\n",(0,r.jsxs)(e.h3,{id:"only-synchronous-io-runs-on-the-main-thread",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#only-synchronous-io-runs-on-the-main-thread",children:"#"}),"Only synchronous I/O runs on the main thread"]}),"\n",(0,r.jsx)(e.p,{children:"For example:"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(e.code,{children:(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" text"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" FileManager"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".readAsStringSync"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(path)"})]})})})}),"\n",(0,r.jsxs)(e.p,{children:["Synchronous methods ",(0,r.jsx)(e.strong,{children:"always"})," execute on the main thread and do ",(0,r.jsx)(e.strong,{children:"not"})," switch threads internally."]}),"\n",(0,r.jsx)(e.p,{children:"Therefore:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Avoid using synchronous I/O on large files"}),"\n",(0,r.jsxs)(e.li,{children:["Prefer asynchronous versions (e.g., ",(0,r.jsx)(e.code,{children:"readAsString"}),") for better performance"]}),"\n",(0,r.jsxs)(e.li,{children:["Use ",(0,r.jsx)(e.code,{children:"runInBackground"})," only when you must perform blocking synchronous work or heavy computation"]}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"recommendations",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#recommendations",children:"#"}),"Recommendations"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["JavaScript runs on the main thread by default; ",(0,r.jsx)(e.code,{children:"runInMain"})," is rarely needed"]}),"\n",(0,r.jsx)(e.li,{children:"Asynchronous I/O methods already run on background threads automatically"}),"\n",(0,r.jsxs)(e.li,{children:["Use ",(0,r.jsx)(e.code,{children:"runInBackground"})," for CPU-heavy or blocking synchronous tasks"]}),"\n",(0,r.jsxs)(e.li,{children:["If an API callback occurs on a background thread, use ",(0,r.jsx)(e.code,{children:"runInMain"})," to safely update UI"]}),"\n",(0,r.jsxs)(e.li,{children:["Do not manipulate UI inside ",(0,r.jsx)(e.code,{children:"runInBackground"}),"; switch back first"]}),"\n"]})]})}function a(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(i,{...n})}):i(n)}a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["en%2Fdoc%2FChangelog%2F2.4.3%2FThread.md"]={toc:[{id:"threadismainthread-boolean",text:"`Thread.isMainThread: boolean`",depth:2},{id:"threadruninmainexecute---void-void",text:"`Thread.runInMain(execute: () => void): void`",depth:2},{id:"threadruninbackgroundtexecute---t--promiset-promiset",text:"`Thread.runInBackground<T>(execute: () => T | Promise<T>): Promise<T>`",depth:2},{id:"automatic-thread-switching-in-asynchronous-io",text:"Automatic Thread Switching in Asynchronous I/O",depth:2},{id:"only-synchronous-io-runs-on-the-main-thread",text:"Only synchronous I/O runs on the main thread",depth:3},{id:"recommendations",text:"Recommendations",depth:2}],title:"Thread",headingTitle:"",frontmatter:{title:"Thread"}}}}]);