"use strict";(self.rspackChunktest=self.rspackChunktest||[]).push([["24139"],{7078(e,s,n){n.r(s),n.d(s,{default:()=>o});var r=n(74848),i=n(28453);function l(e){let s={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"OAuth2"})," 类用于在脚本中实现 OAuth 2.0 授权流程。它支持标准的授权码流程、PKCE（Proof Key for Code Exchange）、访问令牌续期及多种配置选项。"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"构造函数",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#构造函数",children:"#"}),"构造函数"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" OAuth2"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(options: {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  consumerKey"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  consumerSecret: string"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  authorizeUrl: string"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  accessTokenUrl"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  responseType: string"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  contentType"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"参数说明",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#参数说明",children:"#"}),"参数说明"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"参数名"}),(0,r.jsx)(s.th,{children:"类型"}),(0,r.jsx)(s.th,{children:"是否必填"}),(0,r.jsx)(s.th,{children:"说明"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"consumerKey"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"是"}),(0,r.jsx)(s.td,{children:"应用的客户端 ID（Client ID）或 Consumer Key。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"consumerSecret"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"是"}),(0,r.jsx)(s.td,{children:"应用的客户端密钥（Client Secret）。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"authorizeUrl"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"是"}),(0,r.jsx)(s.td,{children:"用于跳转用户授权的地址。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"accessTokenUrl"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"否"}),(0,r.jsx)(s.td,{children:"获取访问令牌（Access Token）的地址，若不提供则使用 authorizeUrl。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"responseType"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"是"}),(0,r.jsxs)(s.td,{children:["一般为 ",(0,r.jsx)(s.code,{children:'"code"'}),"，表示使用授权码流程。"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"contentType"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"否"}),(0,r.jsxs)(s.td,{children:["请求令牌时使用的内容类型，默认值为 ",(0,r.jsx)(s.code,{children:'"application/x-www-form-urlencoded"'}),"。"]})]})]})]}),"\n",(0,r.jsxs)(s.h3,{id:"抛出错误",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#抛出错误",children:"#"}),"抛出错误"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"当配置参数无效或实例化失败时抛出错误。"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"属性",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#属性",children:"#"}),"属性"]}),"\n",(0,r.jsxs)(s.h3,{id:"accesstokenbasicauthentification-boolean",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#accesstokenbasicauthentification-boolean",children:"#"}),(0,r.jsx)(s.code,{children:"accessTokenBasicAuthentification: boolean"})]}),"\n",(0,r.jsxs)(s.p,{children:["是否使用 Basic 认证方式发送获取访问令牌的请求。默认值为 ",(0,r.jsx)(s.code,{children:"false"}),"。"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h3,{id:"allowmissingstatecheck-boolean",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#allowmissingstatecheck-boolean",children:"#"}),(0,r.jsx)(s.code,{children:"allowMissingStateCheck: boolean"})]}),"\n",(0,r.jsxs)(s.p,{children:["是否禁用 ",(0,r.jsx)(s.code,{children:"state"})," 参数校验（CSRF 保护）。",(0,r.jsx)(s.strong,{children:"谨慎使用"}),"，默认值为 ",(0,r.jsx)(s.code,{children:"false"}),"。"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h3,{id:"encodecallbackurl-boolean",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#encodecallbackurl-boolean",children:"#"}),(0,r.jsx)(s.code,{children:"encodeCallbackURL: boolean"})]}),"\n",(0,r.jsxs)(s.p,{children:["是否对回调地址进行 URL 编码。某些服务商要求必须编码。默认值为 ",(0,r.jsx)(s.code,{children:"true"}),"。"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h3,{id:"encodecallbackurlquery-boolean",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#encodecallbackurlquery-boolean",children:"#"}),(0,r.jsx)(s.code,{children:"encodeCallbackURLQuery: boolean"})]}),"\n",(0,r.jsxs)(s.p,{children:["是否对整个回调地址的查询参数进行编码。部分服务如 Imgur 要求此值为 ",(0,r.jsx)(s.code,{children:"false"}),"。默认值为 ",(0,r.jsx)(s.code,{children:"true"}),"。"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"方法",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#方法",children:"#"}),"方法"]}),"\n",(0,r.jsxs)(s.h3,{id:"authorizeoptions-promiseoauthcredential",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#authorizeoptions-promiseoauthcredential",children:"#"}),(0,r.jsx)(s.code,{children:"authorize(options): Promise<OAuthCredential>"})]}),"\n",(0,r.jsx)(s.p,{children:"发起 OAuth2 授权流程。将打开一个浏览器窗口，供用户登录并授权。"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"authorize"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(options: {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  callbackURL?"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  scope: string"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  state: string"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  parameters"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" Record"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"string"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" any>"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  headers?"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" Record"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"string"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string>"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ({"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  codeVerifier"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  codeChallenge: string"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  codeChallengeMethod: string"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  codeVerifier?"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" never"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  codeChallenge"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" never"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  codeChallengeMethod"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" never"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})): "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Promise"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"OAuthCredential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]})]})})}),"\n",(0,r.jsxs)(s.h4,{id:"参数说明-1",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#参数说明-1",children:"#"}),"参数说明"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"参数名"}),(0,r.jsx)(s.th,{children:"类型"}),(0,r.jsx)(s.th,{children:"是否必填"}),(0,r.jsx)(s.th,{children:"说明"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"callbackURL"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"否"}),(0,r.jsxs)(s.td,{children:["授权成功后的回调地址，默认为 ",(0,r.jsx)(s.code,{children:"scripting://oauth_callback/脚本名称"}),"。"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"scope"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"是"}),(0,r.jsx)(s.td,{children:"空格分隔的权限列表。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"state"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"是"}),(0,r.jsx)(s.td,{children:"防止 CSRF 攻击的随机字符串。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"parameters"}),(0,r.jsx)(s.td,{children:"Record<string, any>"}),(0,r.jsx)(s.td,{children:"否"}),(0,r.jsx)(s.td,{children:"附加的授权请求参数。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"headers"}),(0,r.jsx)(s.td,{children:"Record<string, string>"}),(0,r.jsx)(s.td,{children:"否"}),(0,r.jsx)(s.td,{children:"附加的请求头。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"codeVerifier"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"条件必填"}),(0,r.jsx)(s.td,{children:"PKCE 流程中使用的随机码。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"codeChallenge"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"条件必填"}),(0,r.jsxs)(s.td,{children:["由 ",(0,r.jsx)(s.code,{children:"codeVerifier"})," 生成的哈希值。"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"codeChallengeMethod"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:'"plain"'})," | ",(0,r.jsx)(s.code,{children:'"S256"'})]}),(0,r.jsx)(s.td,{children:"条件必填"}),(0,r.jsxs)(s.td,{children:["PKCE 中的 challenge 加密方法，默认使用 ",(0,r.jsx)(s.code,{children:'"S256"'}),"。"]})]})]})]}),"\n",(0,r.jsxs)(s.h4,{id:"返回值",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#返回值",children:"#"}),"返回值"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["返回一个包含授权结果的 ",(0,r.jsx)(s.code,{children:"OAuthCredential"})," 对象。"]}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"抛出错误-1",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#抛出错误-1",children:"#"}),"抛出错误"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"若用户拒绝授权或网络错误将抛出异常。"}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"示例",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#示例",children:"#"}),"示例"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" oauth"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" OAuth2"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  consumerKey"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '你的客户端ID'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  consumerSecret"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '你的客户端密钥'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  authorizeUrl"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'https://provider.com/oauth/authorize'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  accessTokenUrl"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'https://provider.com/oauth/token'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  responseType"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'code'"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" credential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" oauth"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".authorize"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  scope"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'profile email'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  state"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'secure_random_state'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  callbackURL"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" Script"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".createOAuthCallbackURLScheme"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'my_oauth_script'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"credential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".oauthToken)"})]})]})})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h3,{id:"renewaccesstokenoptions-promiseoauthcredential",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#renewaccesstokenoptions-promiseoauthcredential",children:"#"}),(0,r.jsx)(s.code,{children:"renewAccessToken(options): Promise<OAuthCredential>"})]}),"\n",(0,r.jsx)(s.p,{children:"使用刷新令牌（refresh token）重新获取访问令牌。"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"renewAccessToken"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(options: {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  refreshToken"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  parameters"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" Record"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"string"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" any>"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  headers?"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" Record"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"string"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" string>"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}): "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Promise"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"OAuthCredential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]})]})})}),"\n",(0,r.jsxs)(s.h4,{id:"参数说明-2",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#参数说明-2",children:"#"}),"参数说明"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"参数名"}),(0,r.jsx)(s.th,{children:"类型"}),(0,r.jsx)(s.th,{children:"是否必填"}),(0,r.jsx)(s.th,{children:"说明"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"refreshToken"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"是"}),(0,r.jsx)(s.td,{children:"上一次授权返回的刷新令牌。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"parameters"}),(0,r.jsx)(s.td,{children:"Record<string, any>"}),(0,r.jsx)(s.td,{children:"否"}),(0,r.jsx)(s.td,{children:"额外的 POST 请求参数。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"headers"}),(0,r.jsx)(s.td,{children:"Record<string, string>"}),(0,r.jsx)(s.td,{children:"否"}),(0,r.jsx)(s.td,{children:"自定义请求头。"})]})]})]}),"\n",(0,r.jsxs)(s.h4,{id:"返回值-1",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#返回值-1",children:"#"}),"返回值"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["返回新的 ",(0,r.jsx)(s.code,{children:"OAuthCredential"})," 对象。"]}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"抛出错误-2",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#抛出错误-2",children:"#"}),"抛出错误"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"若刷新失败（如刷新令牌已过期），则抛出错误。"}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"示例-1",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#示例-1",children:"#"}),"示例"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" newCredential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" oauth"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".renewAccessToken"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  refreshToken"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" oldCredential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".oauthRefreshToken"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"newCredential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".oauthToken)"})]})]})})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"oauthcredential-类型定义",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#oauthcredential-类型定义",children:"#"}),"OAuthCredential 类型定义"]}),"\n",(0,r.jsx)(s.p,{children:"授权成功后返回的凭证对象包含以下字段："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" OAuthCredential"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  oauthToken"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" string"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  oauthTokenSecret"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" string"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  oauthRefreshToken"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" string"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  oauthTokenExpiresAt"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" number"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" |"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" null"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  oauthVerifier"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" string"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  version"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" string"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  signatureMethod"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" string"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"字段说明",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#字段说明",children:"#"}),"字段说明"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"字段名"}),(0,r.jsx)(s.th,{children:"类型"}),(0,r.jsx)(s.th,{children:"说明"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"oauthToken"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"用于访问资源的 Access Token。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"oauthTokenSecret"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"与访问令牌配套使用的 Token Secret，常用于 OAuth1.0 流程。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"oauthRefreshToken"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"用于获取新访问令牌的 Refresh Token。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"oauthTokenExpiresAt"}),(0,r.jsx)(s.td,{children:"number | null"}),(0,r.jsxs)(s.td,{children:["访问令牌的过期时间（Unix 毫秒时间戳），若无过期则为 ",(0,r.jsx)(s.code,{children:"null"}),"。"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"oauthVerifier"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsx)(s.td,{children:"在 PKCE 流程中使用的授权码验证器。"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"version"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsxs)(s.td,{children:["OAuth 协议版本（例如 ",(0,r.jsx)(s.code,{children:'"2.0"'}),"）。"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"signatureMethod"}),(0,r.jsx)(s.td,{children:"string"}),(0,r.jsxs)(s.td,{children:["请求签名方式（如 ",(0,r.jsx)(s.code,{children:'"HMAC-SHA1"'}),"、",(0,r.jsx)(s.code,{children:'"PLAINTEXT"'}),"）。"]})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.h2,{id:"使用建议",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#使用建议",children:"#"}),"使用建议"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["始终使用 ",(0,r.jsx)(s.code,{children:"state"})," 参数防止 CSRF 攻击，除非明确关闭。"]}),"\n",(0,r.jsxs)(s.li,{children:["使用 ",(0,r.jsx)(s.code,{children:"Script.createOAuthCallbackURLScheme(name)"})," 为脚本生成唯一回调地址。"]}),"\n",(0,r.jsxs)(s.li,{children:["若需要长期授权，请妥善保存 ",(0,r.jsx)(s.code,{children:"oauthRefreshToken"}),"。"]}),"\n",(0,r.jsx)(s.li,{children:"对于公用客户端建议启用 PKCE 增强安全性。"}),"\n"]})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["TestFlight%2Fzh%2Fguide%2FUtilities%2FOAuth2.md"]={toc:[{id:"构造函数",text:"构造函数",depth:2},{id:"参数说明",text:"参数说明",depth:3},{id:"抛出错误",text:"抛出错误",depth:3},{id:"属性",text:"属性",depth:2},{id:"accesstokenbasicauthentification-boolean",text:"`accessTokenBasicAuthentification: boolean`",depth:3},{id:"allowmissingstatecheck-boolean",text:"`allowMissingStateCheck: boolean`",depth:3},{id:"encodecallbackurl-boolean",text:"`encodeCallbackURL: boolean`",depth:3},{id:"encodecallbackurlquery-boolean",text:"`encodeCallbackURLQuery: boolean`",depth:3},{id:"方法",text:"方法",depth:2},{id:"authorizeoptions-promiseoauthcredential",text:"`authorize(options): Promise<OAuthCredential>`",depth:3},{id:"参数说明-1",text:"参数说明",depth:4},{id:"返回值",text:"返回值",depth:4},{id:"抛出错误-1",text:"抛出错误",depth:4},{id:"示例",text:"示例",depth:4},{id:"renewaccesstokenoptions-promiseoauthcredential",text:"`renewAccessToken(options): Promise<OAuthCredential>`",depth:3},{id:"参数说明-2",text:"参数说明",depth:4},{id:"返回值-1",text:"返回值",depth:4},{id:"抛出错误-2",text:"抛出错误",depth:4},{id:"示例-1",text:"示例",depth:4},{id:"oauthcredential-类型定义",text:"OAuthCredential 类型定义",depth:2},{id:"字段说明",text:"字段说明",depth:3},{id:"使用建议",text:"使用建议",depth:2}],title:"OAuth2",headingTitle:"",frontmatter:{title:"OAuth2",description:"该接口提供了一种简单的方法来使用 OAuth2 协议进行用户身份验证和资源访问授权。"}}}}]);