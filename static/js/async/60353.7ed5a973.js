"use strict";(self.rspackChunktest=self.rspackChunktest||[]).push([["60353"],{47416(s,n,e){e.r(n),e.d(n,{default:()=>l});var r=e(74848),i=e(28453);function o(s){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...s.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["IntentMemoryStorage 是一个用于 ",(0,r.jsx)(n.strong,{children:"在多个 AppIntent 执行之间保留临时数据"})," 的内存存储系统。然而，它的生命周期并不严格绑定在单次 AppIntent 或 Script.exit 以上，而是由系统对 Extension 环境（Intent Extension / Widget Extension）的运行状态决定，因此具有一定的非确定性。"]}),"\n",(0,r.jsx)(n.p,{children:"以下文档基于你之前确认的完整版结构，并加入系统行为的解释。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"概述",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#概述",children:"#"}),"概述"]}),"\n",(0,r.jsxs)(n.p,{children:["在 Scripting 中，每个 AppIntent 都运行在其所属脚本的 ",(0,r.jsx)(n.strong,{children:"脚本执行上下文（Script Execution Context）"})," 中。当 AppIntent 的 ",(0,r.jsx)(n.code,{children:"perform()"})," 执行完成，或在 ",(0,r.jsx)(n.code,{children:"intent.tsx"})," 中调用 ",(0,r.jsx)(n.code,{children:"Script.exit()"})," 时，当前 AppIntent 的执行流程会结束。"]}),"\n",(0,r.jsx)(n.p,{children:"但关键点是："}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"IntentMemoryStorage 不会在 AppIntent 或 Script.exit 结束时被立即销毁"})}),"\n",(0,r.jsx)(n.p,{children:"它的生命周期依赖于："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"系统是否继续保留当前 Extension 进程"}),"\n",(0,r.jsx)(n.li,{children:"系统是否因为内存压力或其他策略回收 Extension"}),"\n",(0,r.jsx)(n.li,{children:"Widget 或 Live Activity 是否仍在使用同一 Extension"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"因此："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["在 Shortcuts 再次运行同一个脚本时\n",(0,r.jsx)(n.strong,{children:"有可能读取到上次设置的 MemoryStorage 值"})]}),"\n",(0,r.jsxs)(n.li,{children:["在 Widget 或 Live Activity 中调用 AppIntent\n",(0,r.jsx)(n.strong,{children:"同一个脚本的 JS Context 可能被重用，因此 MemoryStorage 也会保留"})]}),"\n",(0,r.jsxs)(n.li,{children:["系统何时清除 MemoryStorage ",(0,r.jsx)(n.strong,{children:"不可预测"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"MemoryStorage 的本质是："}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"存储在当前 Extension 进程中的短期内存，非持久化、非可靠、非严格会话级"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"作用范围scopes",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#作用范围scopes",children:"#"}),"作用范围（Scopes）"]}),"\n",(0,r.jsx)(n.p,{children:"IntentMemoryStorage 提供两类存储区域："}),"\n",(0,r.jsxs)(n.h2,{id:"1-脚本级script-scoped存储",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#1-脚本级script-scoped存储",children:"#"}),"1. 脚本级（Script-scoped）存储"]}),"\n",(0,r.jsx)(n.p,{children:"默认行为。"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"属于单个脚本项目"}),"\n",(0,r.jsx)(n.li,{children:"脚本 A 不能访问脚本 B 的脚本级存储"}),"\n",(0,r.jsx)(n.li,{children:"Extension 不被系统销毁时，会保留该脚本的存储"}),"\n",(0,r.jsx)(n.li,{children:"Extension 一旦被销毁，存储也随之清空"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"适用于该脚本内部多步骤流程。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"2-共享shared存储",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#2-共享shared存储",children:"#"}),"2. 共享（Shared）存储"]}),"\n",(0,r.jsxs)(n.p,{children:["使用 ",(0,r.jsx)(n.code,{children:"{ shared: true }"})," 可访问一个共享区域："]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"所有脚本的 AppIntent 都可访问"}),"\n",(0,r.jsx)(n.li,{children:"在 Extension 未被系统释放前可以持续存在"}),"\n",(0,r.jsx)(n.li,{children:"Extension 被销毁后清空"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"适合在多个脚本之间协调状态。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"extension-生命周期与-js-context-行为",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#extension-生命周期与-js-context-行为",children:"#"}),"Extension 生命周期与 JS Context 行为"]}),"\n",(0,r.jsxs)(n.h2,{id:"情况一在-shortcuts-中运行-intent",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#情况一在-shortcuts-中运行-intent",children:"#"}),"情况一：在 Shortcuts 中运行 Intent"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Shortcuts 执行完成后："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"当前 JS Context 会被销毁"}),"\n",(0,r.jsx)(n.li,{children:"当前 AppIntent 执行结束"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["但：",(0,r.jsx)(n.strong,{children:"IntentMemoryStorage 不一定被销毁"}),"\n因为系统未必会立即销毁 Intent Extension"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"因此："}),"\n",(0,r.jsxs)(n.h3,{id:"再次运行同一个脚本时可能读到上次的数据",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#再次运行同一个脚本时可能读到上次的数据",children:"#"}),"再次运行同一个脚本时，可能读到上次的数据。"]}),"\n",(0,r.jsx)(n.p,{children:"例："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "red"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"下一次 Shortcut 再运行时："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" c"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".get"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})})})}),"\n",(0,r.jsxs)(n.p,{children:["可能仍然得到 ",(0,r.jsx)(n.code,{children:'"red"'}),"。"]}),"\n",(0,r.jsx)(n.p,{children:"这是系统层面的行为，并非 Scripting 的行为。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"情况二在小组件widgetcontrol-widget中调用-appintent",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#情况二在小组件widgetcontrol-widget中调用-appintent",children:"#"}),"情况二：在小组件（Widget/Control Widget）中调用 AppIntent"]}),"\n",(0,r.jsx)(n.p,{children:"Widget Extension 的特点："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Scripting 会尽量复用 JS Context"}),"\n",(0,r.jsx)(n.li,{children:"即使 AppIntent 执行结束，JS Context 也可能继续存在"}),"\n",(0,r.jsx)(n.li,{children:"因此 MemoryStorage 也可能持续存在"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"但："}),"\n",(0,r.jsxs)(n.h3,{id:"系统随时可能回收-extension尤其在内存压力下js-context-和-memorystorage-都会被清空",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#系统随时可能回收-extension尤其在内存压力下js-context-和-memorystorage-都会被清空",children:"#"}),"系统随时可能回收 Extension（尤其在内存压力下），JS Context 和 MemoryStorage 都会被清空。"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"情况三live-activity-调用-appintent",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#情况三live-activity-调用-appintent",children:"#"}),"情况三：Live Activity 调用 AppIntent"]}),"\n",(0,r.jsx)(n.p,{children:"Live Activity Extension 也可能复用上下文："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"多次调用 AppIntent 通常复用同一 JS Context"}),"\n",(0,r.jsx)(n.li,{children:"MemoryStorage 可能继续保留"}),"\n",(0,r.jsx)(n.li,{children:"但系统没有保证稳定性"}),"\n",(0,r.jsx)(n.li,{children:"扩展环境被杀死后 MemoryStorage 立即失效"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"总结生命周期非常关键",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#总结生命周期非常关键",children:"#"}),"总结生命周期（非常关键）"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"行为"}),(0,r.jsx)(n.th,{children:"是否导致 MemoryStorage 清空"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"AppIntent 执行结束"}),(0,r.jsx)(n.td,{children:"否"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Script.exit()"}),(0,r.jsx)(n.td,{children:"否"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Shortcut 流程结束"}),(0,r.jsx)(n.td,{children:"不一定"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Widget 更新 AppIntent"}),(0,r.jsx)(n.td,{children:"不一定"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Live Activity 调用 AppIntent"}),(0,r.jsx)(n.td,{children:"不一定"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"系统回收 Extension 进程"}),(0,r.jsx)(n.td,{children:"是（彻底清空）"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["MemoryStorage 的生命周期与 ",(0,r.jsx)(n.strong,{children:"Extension 进程生命周期"})," 完全一致，而 Extension 何时被系统保留/销毁是不可预测的系统行为。"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"api-定义",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#api-定义",children:"#"}),"API 定义"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"namespace"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" get"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" T"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" |"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" null"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" value"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" any"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" remove"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" contains"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" clear"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" keys"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[]"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsx)(n.p,{children:"说明："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"shared"})," 仅作用于 get / set / remove / contains"]}),"\n",(0,r.jsx)(n.li,{children:"clear() 和 keys() 始终只针对脚本级存储区域"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"api-详细说明",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#api-详细说明",children:"#"}),"API 详细说明"]}),"\n",(0,r.jsxs)(n.h2,{id:"get",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#get",children:"#"}),"get"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" get"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" T"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" |"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" null"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"读取键值。注意："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"若 Extension 尚未被销毁，则可能读到上一次执行留下的值"}),"\n",(0,r.jsx)(n.li,{children:"若系统已清理 Extension，则可能返回 null"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"脚本级："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" color"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".get"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"shared："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" token"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".get"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"token"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]})})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"set",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#set",children:"#"}),"set"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" value"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" any"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"写入存储区域。"}),"\n",(0,r.jsx)(n.p,{children:"脚本级："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "systemBlue"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"shared："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"sessionID"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "abc123"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]})})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"remove",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#remove",children:"#"}),"remove"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" remove"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"删除键值。"}),"\n",(0,r.jsx)(n.p,{children:"脚本级："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".remove"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"shared："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".remove"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"sessionID"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]})})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"contains",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#contains",children:"#"}),"contains"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" contains"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(key"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" options"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"检查键是否存在。\n注意：此结果取决于当前 Extension 是否仍在。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"clear",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#clear",children:"#"}),"clear"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" clear"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"清空脚本级存储。\nshared 区域不会被清空。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"keys",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#keys",children:"#"}),"keys"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" keys"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[]"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"返回脚本级存储的 key 列表。"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"使用场景",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#使用场景",children:"#"}),"使用场景"]}),"\n",(0,r.jsxs)(n.h2,{id:"脚本级默认",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#脚本级默认",children:"#"}),"脚本级（默认）"]}),"\n",(0,r.jsx)(n.p,{children:"适用于："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"单脚本的多步骤流程"}),"\n",(0,r.jsx)(n.li,{children:"融合 SnippetIntent → AppIntent → SnippetIntent"}),"\n",(0,r.jsx)(n.li,{children:"临时保存当前 UI 状态、表单数据、步骤编号"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"示例："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"step"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 2"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"shared跨脚本",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#shared跨脚本",children:"#"}),"shared（跨脚本）"]}),"\n",(0,r.jsx)(n.p,{children:"适用于："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"多脚本协同"}),"\n",(0,r.jsx)(n.li,{children:"工作流中跨多个项目传递会话状态"}),"\n",(0,r.jsx)(n.li,{children:"保存当前 Shortcut 全局状态"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"示例："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"workflowID"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "xyz"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]})})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"不适用用途",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#不适用用途",children:"#"}),"不适用用途"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"不保证一定存在"}),"\n",(0,r.jsx)(n.li,{children:"不保证一定被清理"}),"\n",(0,r.jsx)(n.li,{children:"不适合存储大对象"}),"\n",(0,r.jsx)(n.li,{children:"不适合存储持久数据"}),"\n",(0,r.jsx)(n.li,{children:"不适合跨天或长期使用（可能在任何时间丢失）"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"推荐持久方案："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Storage"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"FileManager"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"示例",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#示例",children:"#"}),"示例"]}),"\n",(0,r.jsxs)(n.h2,{id:"脚本级示例",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#脚本级示例",children:"#"}),"脚本级示例"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(n.code,{children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "red"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" color"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".get"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})]})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"shared-跨脚本示例",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#shared-跨脚本示例",children:"#"}),"shared 跨脚本示例"]}),"\n",(0,r.jsx)(n.p,{children:"Script A："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"sessionID"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "12345"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]})})})}),"\n",(0,r.jsx)(n.p,{children:"Script B："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(n.code,{children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" id"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" IntentMemoryStorage"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".get"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"sessionID"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { shared"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]})})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"存储结构示例",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#存储结构示例",children:"#"}),"存储结构示例"]}),"\n",(0,r.jsx)(n.p,{children:"脚本级："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"json",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'  "color"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "green"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'  "step"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 2"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsx)(n.p,{children:"shared："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"json",children:(0,r.jsxs)(n.code,{children:[(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:'  "token"'}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "xyz"'})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h1,{id:"最佳实践",children:[(0,r.jsx)(n.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#最佳实践",children:"#"}),"最佳实践"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"不保证 MemoryStorage 一定存在或一定被清理"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"不要用于关键数据"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"不要用于大数据存储"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"对 shared 使用清晰命名，例如："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:'"global.sessionID"'})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:'"workflow.status"'})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"在依赖该存储前考虑数据可能不存在"}),"\n"]}),"\n"]})]})}function l(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}={...(0,i.R)(),...s.components};return n?(0,r.jsx)(n,{...s,children:(0,r.jsx)(o,{...s})}):o(s)}l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["TestFlight%2Fzh%2Fguide%2FChangelog%2F2.4.4%2FIntentMemoryStorage.md"]={toc:[{id:"1-脚本级script-scoped存储",text:"1. 脚本级（Script-scoped）存储",depth:2},{id:"2-共享shared存储",text:"2. 共享（Shared）存储",depth:2},{id:"情况一在-shortcuts-中运行-intent",text:"情况一：在 Shortcuts 中运行 Intent",depth:2},{id:"再次运行同一个脚本时可能读到上次的数据",text:"再次运行同一个脚本时，可能读到上次的数据。",depth:3},{id:"情况二在小组件widgetcontrol-widget中调用-appintent",text:"情况二：在小组件（Widget/Control Widget）中调用 AppIntent",depth:2},{id:"系统随时可能回收-extension尤其在内存压力下js-context-和-memorystorage-都会被清空",text:"系统随时可能回收 Extension（尤其在内存压力下），JS Context 和 MemoryStorage 都会被清空。",depth:3},{id:"情况三live-activity-调用-appintent",text:"情况三：Live Activity 调用 AppIntent",depth:2},{id:"总结生命周期非常关键",text:"总结生命周期（非常关键）",depth:2},{id:"get",text:"get",depth:2},{id:"set",text:"set",depth:2},{id:"remove",text:"remove",depth:2},{id:"contains",text:"contains",depth:2},{id:"clear",text:"clear",depth:2},{id:"keys",text:"keys",depth:2},{id:"脚本级默认",text:"脚本级（默认）",depth:2},{id:"shared跨脚本",text:"shared（跨脚本）",depth:2},{id:"脚本级示例",text:"脚本级示例",depth:2},{id:"shared-跨脚本示例",text:"shared 跨脚本示例",depth:2}],title:"IntentMemoryStorage",headingTitle:"概述",frontmatter:{title:"IntentMemoryStorage",description:"一个轻量级，会话级的存储，可在单个快捷指令执行过程中跨多 AppIntent 共享状态。"}}}}]);