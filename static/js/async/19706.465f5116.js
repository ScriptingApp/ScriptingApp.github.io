"use strict";(self.rspackChunktest=self.rspackChunktest||[]).push([["19706"],{32481(s,e,r){r.r(e),r.d(e,{default:()=>l});var n=r(74848),i=r(28453);function o(s){let e={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:"HttpServer"})," 类提供了在本地或局域网中启动一个轻量级 HTTP 服务器的能力，可用于处理 HTTP 请求、静态文件服务、WebSocket 通信等场景。该类在脚本中常用于本地 Web 调试、远程控制、设备通信等。"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h2,{id:"概述",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#概述",children:"#"}),"概述"]}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:"HttpServer"})," 支持以下功能："]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"处理自定义路径的 HTTP 请求。"}),"\n",(0,n.jsx)(e.li,{children:"提供静态文件或目录的访问。"}),"\n",(0,n.jsx)(e.li,{children:"注册 WebSocket 服务端，实现实时通信。"}),"\n",(0,n.jsx)(e.li,{children:"支持 IPv4 与 IPv6 地址。"}),"\n",(0,n.jsx)(e.li,{children:"可选择端口号（支持随机端口）。"}),"\n",(0,n.jsx)(e.li,{children:"支持服务器状态查询。"}),"\n"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h2,{id:"属性",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#属性",children:"#"}),"属性"]}),"\n",(0,n.jsxs)(e.h3,{id:"state-httpserverstate",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#state-httpserverstate",children:"#"}),(0,n.jsx)(e.code,{children:"state: HttpServerState"})]}),"\n",(0,n.jsx)(e.p,{children:"服务器当前状态。\n可能值包括："}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"状态"}),(0,n.jsx)(e.th,{children:"说明"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:'"starting"'})}),(0,n.jsx)(e.td,{children:"正在启动服务器。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:'"running"'})}),(0,n.jsx)(e.td,{children:"服务器运行中。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:'"stopping"'})}),(0,n.jsx)(e.td,{children:"正在停止服务器。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:'"stopped"'})}),(0,n.jsx)(e.td,{children:"服务器已停止。"})]})]})]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"port-number--null",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#port-number--null",children:"#"}),(0,n.jsx)(e.code,{children:"port: number | null"})]}),"\n",(0,n.jsxs)(e.p,{children:["服务器监听的端口号。\n如果服务器未运行，则为 ",(0,n.jsx)(e.code,{children:"null"}),"。"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"isipv4-boolean",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#isipv4-boolean",children:"#"}),(0,n.jsx)(e.code,{children:"isIPv4: boolean"})]}),"\n",(0,n.jsxs)(e.p,{children:["指示服务器是否在 IPv4 地址上监听。若为 ",(0,n.jsx)(e.code,{children:"false"}),"，则可能监听 IPv6 地址。"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"listenaddressipv4-string--null",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#listenaddressipv4-string--null",children:"#"}),(0,n.jsx)(e.code,{children:"listenAddressIPv4: string | null"})]}),"\n",(0,n.jsxs)(e.p,{children:["IPv4 监听地址，仅当 ",(0,n.jsx)(e.code,{children:"forceIPv4"})," 为 ",(0,n.jsx)(e.code,{children:"true"})," 时使用。"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"listenaddressipv6-string--null",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#listenaddressipv6-string--null",children:"#"}),(0,n.jsx)(e.code,{children:"listenAddressIPv6: string | null"})]}),"\n",(0,n.jsxs)(e.p,{children:["IPv6 监听地址，仅当 ",(0,n.jsx)(e.code,{children:"forceIPv6"})," 为 ",(0,n.jsx)(e.code,{children:"true"})," 时使用。"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h2,{id:"方法",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#方法",children:"#"}),"方法"]}),"\n",(0,n.jsxs)(e.h3,{id:"registerhandlerpath-string-handler-request-httprequest--httpresponse-void",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#registerhandlerpath-string-handler-request-httprequest--httpresponse-void",children:"#"}),(0,n.jsx)(e.code,{children:"registerHandler(path: string, handler: (request: HttpRequest) => HttpResponse): void"})]}),"\n",(0,n.jsx)(e.p,{children:"为指定路径注册一个 HTTP 请求处理器。"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"参数："})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"参数"}),(0,n.jsx)(e.th,{children:"类型"}),(0,n.jsx)(e.th,{children:"说明"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"path"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"string"})}),(0,n.jsxs)(e.td,{children:["请求路径（支持动态参数，例如 ",(0,n.jsx)(e.code,{children:"/user/:id"}),"）。"]})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"handler"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"(request: HttpRequest) => HttpResponse"})}),(0,n.jsx)(e.td,{children:"处理函数，接收请求对象并返回响应对象。"})]})]})]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"示例："})}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" HttpServer"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".registerHandler"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/hello"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (req) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" HttpResponse"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".ok"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"HttpResponseBody"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".text"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Hello, world!"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"))"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"registerfilepath-string-filepath-string-void",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#registerfilepath-string-filepath-string-void",children:"#"}),(0,n.jsx)(e.code,{children:"registerFile(path: string, filePath: string): void"})]}),"\n",(0,n.jsx)(e.p,{children:"为指定路径注册一个静态文件响应。"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"参数："})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"参数"}),(0,n.jsx)(e.th,{children:"类型"}),(0,n.jsx)(e.th,{children:"说明"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"path"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"string"})}),(0,n.jsx)(e.td,{children:"请求路径。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"filePath"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"string"})}),(0,n.jsx)(e.td,{children:"要响应的文件路径。"})]})]})]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"示例："})}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsx)(e.code,{children:(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".registerFile"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/readme"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" Path"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Script"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".directory"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "README.md"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"))"})]})})})}),"\n",(0,n.jsxs)(e.p,{children:["当访问 ",(0,n.jsx)(e.code,{children:"/readme"})," 时，服务器将返回该文件的内容。"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"registerfilesfromdirectorypath-string-directory-string-options--defaults-string--void",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#registerfilesfromdirectorypath-string-directory-string-options--defaults-string--void",children:"#"}),(0,n.jsx)(e.code,{children:"registerFilesFromDirectory(path: string, directory: string, options?: { defaults?: string[] }): void"})]}),"\n",(0,n.jsx)(e.p,{children:"注册指定目录下的所有文件，使其可通过 HTTP 访问。"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"参数："})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"参数"}),(0,n.jsx)(e.th,{children:"类型"}),(0,n.jsx)(e.th,{children:"说明"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"path"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"string"})}),(0,n.jsxs)(e.td,{children:["路径模板，例如 ",(0,n.jsx)(e.code,{children:"/static/:file"}),"。"]})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"directory"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"string"})}),(0,n.jsx)(e.td,{children:"目录路径。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"options.defaults"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"string[]"})}),(0,n.jsxs)(e.td,{children:["默认文件名，若未指定文件则尝试加载此列表中的文件（默认：",(0,n.jsx)(e.code,{children:'["index.html", "default.html"]'}),"）。"]})]})]})]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"示例："})}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".registerFilesFromDirectory"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/static/:file"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" Path"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Script"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".directory"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "html"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  defaults"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ["}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"index.html"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "index.htm"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"]"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,n.jsxs)(e.p,{children:["当访问 ",(0,n.jsx)(e.code,{children:"/static/"})," 时，会返回该目录下的默认首页文件。"]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"registerwebsocketpath-string-handlers-websockethandlers-void",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#registerwebsocketpath-string-handlers-websockethandlers-void",children:"#"}),(0,n.jsx)(e.code,{children:"registerWebsocket(path: string, handlers: WebSocketHandlers): void"})]}),"\n",(0,n.jsx)(e.p,{children:"注册 WebSocket 服务端处理程序，用于实时通信。"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"参数："})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"参数"}),(0,n.jsx)(e.th,{children:"类型"}),(0,n.jsx)(e.th,{children:"说明"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"path"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"string"})}),(0,n.jsx)(e.td,{children:"WebSocket 路径。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"handlers"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"WebSocketHandlers"})}),(0,n.jsx)(e.td,{children:"WebSocket 事件处理函数。"})]})]})]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"WebSocketHandlers 类型定义："})}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"interface"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocketHandlers"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  onPong"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocketSession"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  onConnected"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocketSession"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  onDisconnected"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocketSession"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  handleText"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocketSession"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" text"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  handleBinary"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocketSession"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" data"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" Data"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" void"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"示例："})}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" connectedSessions"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" WebSocketSession"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"[] "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" []"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".registerWebsocket"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/ws"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  onConnected"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    connectedSessions"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".push"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(session)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  onDisconnected"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    connectedSessions"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".splice"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"connectedSessions"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".indexOf"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(session)"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" 1"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  handleText"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" text) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".writeText"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Echo: "'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" +"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" text)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"startoptions--port-number-forceipv4-boolean--string--null",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#startoptions--port-number-forceipv4-boolean--string--null",children:"#"}),(0,n.jsx)(e.code,{children:"start(options?: { port?: number; forceIPv4?: boolean }): string | null"})]}),"\n",(0,n.jsx)(e.p,{children:"启动服务器。"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"参数："})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"参数"}),(0,n.jsx)(e.th,{children:"类型"}),(0,n.jsx)(e.th,{children:"说明"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"options.port"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"number"})}),(0,n.jsxs)(e.td,{children:["指定监听端口，默认为 ",(0,n.jsx)(e.code,{children:"8080"}),"。如果设为 ",(0,n.jsx)(e.code,{children:"0"}),"，则自动选择可用端口。"]})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"options.forceIPv4"})}),(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"boolean"})}),(0,n.jsxs)(e.td,{children:["是否强制使用 IPv4 地址，默认 ",(0,n.jsx)(e.code,{children:"false"}),"。"]})]})]})]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"返回值："})}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"若启动失败，返回错误消息字符串。"}),"\n",(0,n.jsxs)(e.li,{children:["若成功，返回 ",(0,n.jsx)(e.code,{children:"null"}),"。"]}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"示例："})}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" error"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".start"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"({ port"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" 8080"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (error) {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".error"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"启动失败:"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" error)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"服务器运行在端口:"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".port)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h3,{id:"stop-void",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#stop-void",children:"#"}),(0,n.jsx)(e.code,{children:"stop(): void"})]}),"\n",(0,n.jsx)(e.p,{children:"停止服务器并释放资源。"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"示例："})}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".stop"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"服务器已停止"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"})]})]})})}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h2,{id:"类型定义",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#类型定义",children:"#"}),"类型定义"]}),"\n",(0,n.jsxs)(e.h3,{id:"httpserverstate",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#httpserverstate",children:"#"}),(0,n.jsx)(e.code,{children:"HttpServerState"})]}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsx)(e.code,{children:(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" HttpServerState"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "starting"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" |"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "running"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" |"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "stopping"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" |"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "stopped"'})]})})})}),"\n",(0,n.jsxs)(e.h3,{id:"websocketsession",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#websocketsession",children:"#"}),(0,n.jsx)(e.code,{children:"WebSocketSession"})]}),"\n",(0,n.jsx)(e.p,{children:"表示一个 WebSocket 连接。"}),"\n",(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:"常用方法："})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"方法"}),(0,n.jsx)(e.th,{children:"说明"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"writeText(text: string)"})}),(0,n.jsx)(e.td,{children:"发送文本消息。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"writeData(data: Data)"})}),(0,n.jsx)(e.td,{children:"发送二进制消息。"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:(0,n.jsx)(e.code,{children:"close()"})}),(0,n.jsx)(e.td,{children:"关闭连接。"})]})]})]}),"\n",(0,n.jsx)(e.hr,{}),"\n",(0,n.jsxs)(e.h2,{id:"综合示例",children:[(0,n.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#综合示例",children:"#"}),"综合示例"]}),"\n",(0,n.jsx)(e.p,{children:"以下示例展示了一个完整的 HTTP 与 WebSocket 服务器："}),"\n",(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" new"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" HttpServer"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 注册简单的 HTTP 处理"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".registerHandler"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/api/hello"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (req) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" HttpResponse"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".ok"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"HttpResponseBody"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".text"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Hello from Scripting Server"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"))"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 注册静态目录"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".registerFilesFromDirectory"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/public/:file"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" Path"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Script"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".directory"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "html"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"))"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 注册 WebSocket 服务"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".registerWebsocket"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/chat"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  onConnected"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"新连接"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".writeText"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"欢迎加入聊天"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  handleText"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" text) "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"收到:"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" text)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    session"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".writeText"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"你说: "'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" +"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" text)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 启动服务器"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" error"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".start"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"({ port"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" 8080"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" })"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (error) {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".error"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"启动失败:"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" error)"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"  console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"HTTP服务器已启动，端口:"'}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" server"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".port)"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})})]})}function l(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}={...(0,i.R)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(o,{...s})}):o(s)}l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["zh%2Fdoc%2FUtilities%2FHttpServer%2FHttpServer.mdx"]={toc:[{id:"概述",text:"概述",depth:2},{id:"属性",text:"属性",depth:2},{id:"state-httpserverstate",text:"`state: HttpServerState`",depth:3},{id:"port-number--null",text:"`port: number | null`",depth:3},{id:"isipv4-boolean",text:"`isIPv4: boolean`",depth:3},{id:"listenaddressipv4-string--null",text:"`listenAddressIPv4: string | null`",depth:3},{id:"listenaddressipv6-string--null",text:"`listenAddressIPv6: string | null`",depth:3},{id:"方法",text:"方法",depth:2},{id:"registerhandlerpath-string-handler-request-httprequest--httpresponse-void",text:"`registerHandler(path: string, handler: (request: HttpRequest) => HttpResponse): void`",depth:3},{id:"registerfilepath-string-filepath-string-void",text:"`registerFile(path: string, filePath: string): void`",depth:3},{id:"registerfilesfromdirectorypath-string-directory-string-options--defaults-string--void",text:"`registerFilesFromDirectory(path: string, directory: string, options?: { defaults?: string[] }): void`",depth:3},{id:"registerwebsocketpath-string-handlers-websockethandlers-void",text:"`registerWebsocket(path: string, handlers: WebSocketHandlers): void`",depth:3},{id:"startoptions--port-number-forceipv4-boolean--string--null",text:"`start(options?: { port?: number; forceIPv4?: boolean }): string | null`",depth:3},{id:"stop-void",text:"`stop(): void`",depth:3},{id:"类型定义",text:"类型定义",depth:2},{id:"httpserverstate",text:"`HttpServerState`",depth:3},{id:"websocketsession",text:"`WebSocketSession`",depth:3},{id:"综合示例",text:"综合示例",depth:2}],title:"HttpServer（HTTP 服务器）",headingTitle:"",frontmatter:{title:"HttpServer（HTTP 服务器）",tag:"PRO"}}}}]);