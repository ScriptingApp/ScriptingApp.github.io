"use strict";(self.rspackChunktest=self.rspackChunktest||[]).push([["30484"],{90879(n,e,s){s.r(e),s.d(e,{default:()=>l});var r=s(74848),i=s(28453);function o(n){let e={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"AppIntentManager"})," 用于在 ",(0,r.jsx)(e.strong,{children:"Scripting"})," 中注册并管理 ",(0,r.jsx)(e.code,{children:"AppIntent"}),"，它是 Widget、Live Activity、ControlWidget 等控件执行脚本逻辑的核心机制。\n所有的 ",(0,r.jsx)(e.code,{children:"AppIntent"})," ",(0,r.jsx)(e.strong,{children:"必须"})," 定义在 ",(0,r.jsx)(e.code,{children:"app_intents.tsx"})," 文件中，且在执行时其运行环境 ",(0,r.jsx)(e.code,{children:"Script.env"})," 为 ",(0,r.jsx)(e.code,{children:'"app_intents"'}),"。"]}),"\n",(0,r.jsxs)(e.p,{children:["通过 ",(0,r.jsx)(e.code,{children:"AppIntentManager"})," 注册的意图可以被 Widget / Live Activity / ControlWidget 中的 ",(0,r.jsx)(e.strong,{children:"Button"})," 与 ",(0,r.jsx)(e.strong,{children:"Toggle"})," 控件调用，以在用户交互时触发对应的脚本逻辑。"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"一类型定义",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#一类型定义",children:"#"}),"一、类型定义"]}),"\n",(0,r.jsxs)(e.h3,{id:"appintentt",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#appintentt",children:"#"}),(0,r.jsx)(e.code,{children:"AppIntent<T>"})]}),"\n",(0,r.jsx)(e.p,{children:"表示一个具体的应用意图实例。"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"字段名"}),(0,r.jsx)(e.th,{children:"类型"}),(0,r.jsx)(e.th,{children:"描述"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"script"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"string"})}),(0,r.jsx)(e.td,{children:"脚本路径，由系统内部生成。"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"name"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"string"})}),(0,r.jsx)(e.td,{children:"意图名称，唯一标识该 AppIntent。"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"protocol"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"AppIntentProtocol"})}),(0,r.jsx)(e.td,{children:"该意图实现的协议类型（如普通、音频播放、音频录制、Live Activity）。"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"params"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"T"})}),(0,r.jsx)(e.td,{children:"意图执行时的参数。"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h3,{id:"appintentfactoryt",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#appintentfactoryt",children:"#"}),(0,r.jsx)(e.code,{children:"AppIntentFactory<T>"})]}),"\n",(0,r.jsxs)(e.p,{children:["表示一个 ",(0,r.jsx)(e.strong,{children:"工厂函数"}),"，用于通过参数创建 ",(0,r.jsx)(e.code,{children:"AppIntent"})," 实例。"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(e.code,{children:(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" AppIntentFactory"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (params"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" AppIntent"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:">"})]})})})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h3,{id:"appintentperformt",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#appintentperformt",children:"#"}),(0,r.jsx)(e.code,{children:"AppIntentPerform<T>"})]}),"\n",(0,r.jsx)(e.p,{children:"表示一个执行函数，用于在意图被触发时执行实际逻辑。"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsx)(e.code,{children:(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" AppIntentPerform"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" (params"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" Promise"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"void"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:">"})]})})})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h3,{id:"appintentprotocol",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#appintentprotocol",children:"#"}),(0,r.jsx)(e.code,{children:"AppIntentProtocol"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"AppIntentProtocol"})," 是枚举类型，用于指定意图的协议（行为类别）。"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"枚举成员"}),(0,r.jsx)(e.th,{children:"描述"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"AppIntent"})," (0)"]}),(0,r.jsx)(e.td,{children:"普通 AppIntent。用于执行一般操作的意图。"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"AudioPlaybackIntent"})," (1)"]}),(0,r.jsx)(e.td,{children:"播放、暂停或修改音频播放状态的意图。"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"AudioRecordingIntent"})," (2)"]}),(0,r.jsxs)(e.td,{children:["（iOS 18.0+）启动、停止或修改音频录制状态的意图。",(0,r.jsx)(e.strong,{children:"注意"}),"：在 iOS/iPadOS 中，当使用 ",(0,r.jsx)(e.code,{children:"AudioRecordingIntent"})," 协议时，必须在开始录音时启动一个 ",(0,r.jsx)(e.strong,{children:"Live Activity"})," 并在录音持续时保持活跃，否则音频录制将会停止。"]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.code,{children:"LiveActivityIntent"})," (3)"]}),(0,r.jsx)(e.td,{children:"启动、暂停或修改 Live Activity 的意图。"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"二appintentmanager-类",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#二appintentmanager-类",children:"#"}),"二、AppIntentManager 类"]}),"\n",(0,r.jsxs)(e.h3,{id:"appintentmanagerregistertoptions-appintentfactoryt",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#appintentmanagerregistertoptions-appintentfactoryt",children:"#"}),(0,r.jsx)(e.code,{children:"AppIntentManager.register<T>(options): AppIntentFactory<T>"})]}),"\n",(0,r.jsxs)(e.p,{children:["注册一个新的 ",(0,r.jsx)(e.code,{children:"AppIntent"}),"。\n通过指定 ",(0,r.jsx)(e.code,{children:"name"}),"、",(0,r.jsx)(e.code,{children:"protocol"})," 和 ",(0,r.jsx)(e.code,{children:"perform"})," 函数来注册，当控件（Button/Toggle）被触发时，系统会自动调用 ",(0,r.jsx)(e.code,{children:"perform"})," 函数执行逻辑。"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"ts",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"static register<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" undefined"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:">(options"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  name"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  protocol"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" AppIntentProtocol"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  perform"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" AppIntentPerform"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:">;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" AppIntentFactory"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"T"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:">"})]})]})})}),"\n",(0,r.jsxs)(e.h4,{id:"参数",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#参数",children:"#"}),"参数："]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"参数名"}),(0,r.jsx)(e.th,{children:"类型"}),(0,r.jsx)(e.th,{children:"描述"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"name"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"string"})}),(0,r.jsx)(e.td,{children:"AppIntent 的名称，需唯一，用于标识该意图。"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"protocol"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"AppIntentProtocol"})}),(0,r.jsx)(e.td,{children:"AppIntent 的协议类型。"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"perform"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"AppIntentPerform<T>"})}),(0,r.jsxs)(e.td,{children:["当控件触发该意图时执行的异步函数，参数为控件传递过来的 ",(0,r.jsx)(e.code,{children:"params"}),"。"]})]})]})]}),"\n",(0,r.jsxs)(e.h4,{id:"返回值",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#返回值",children:"#"}),"返回值："]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"AppIntentFactory<T>"})}),"：返回一个工厂函数，可通过传入参数创建 ",(0,r.jsx)(e.code,{children:"AppIntent"})," 实例。"]}),"\n"]}),"\n",(0,r.jsxs)(e.h4,{id:"示例",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#示例",children:"#"}),"示例："]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"tsx",children:(0,r.jsxs)(e.code,{children:[(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"/// app_intents.tsx"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" const"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" ToggleDoorIntent"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" AppIntentManager"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".register"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  name"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "ToggleDoorIntent"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  protocol"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" AppIntentProtocol"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:".AppIntent"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  perform"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" async"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" ({ id"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" newState }"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" { id"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"; newState"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:" boolean"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" }) "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 自定义逻辑：切换门的状态"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"    await"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:" setDoorState"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"(id"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" newState)"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 通知控件刷新状态（如 ControlWidgetToggle）"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"    ControlWidget"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".reloadToggles"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"})"})})]})})}),"\n",(0,r.jsxs)(e.p,{children:["在控件文件中（如 ",(0,r.jsx)(e.code,{children:"control_widget_toggle.tsx"}),"）："]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"tsx",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"ControlWidget"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".present"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  <"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"ControlWidgetToggle"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"    intent"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"ToggleDoorIntent"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"({ id"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "door1"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" newState"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" !"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"currentState })}"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"    label"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"{{"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      title"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "Door 1"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"      systemImage"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" currentState "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "door.garage.opened"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" :"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "door.garage.closed"'})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"    }}"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"    activeValueLabel"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"{{ title"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "The door is opened"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" }}"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"    inactiveValueLabel"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"{{ title"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "The door is closed"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" }}"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"  />"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:")"})})]})})}),"\n",(0,r.jsxs)(e.p,{children:["在小组件中使用（如 ",(0,r.jsx)(e.code,{children:"widget.tsx"}),"）:"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"tsx",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Toggle"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  title"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Door 1"'})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  value"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"{currentState}"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"  intent"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"ToggleDoorIntent"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"({ id"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "door1"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:" newState"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" !"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"currentState })}"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-foreground)"},children:"/>"})})]})})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"三执行时环境",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#三执行时环境",children:"#"}),"三、执行时环境"]}),"\n",(0,r.jsxs)(e.p,{children:["所有通过 ",(0,r.jsx)(e.code,{children:"AppIntentManager"})," 定义的 AppIntent 在执行时，",(0,r.jsx)(e.code,{children:"Script.env"})," 会自动为 ",(0,r.jsx)(e.code,{children:'"app_intents"'}),"。\n这意味着在 ",(0,r.jsx)(e.code,{children:"perform"})," 函数中可以安全地使用适合 ",(0,r.jsx)(e.code,{children:'"app_intents"'})," 环境的 API（如访问网络、更新 Live Activity 状态、触发控件刷新等）。"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.h2,{id:"四最佳实践",children:[(0,r.jsx)(e.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#四最佳实践",children:"#"}),"四、最佳实践"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"集中管理"}),"：所有 AppIntent 必须定义在 ",(0,r.jsx)(e.code,{children:"app_intents.tsx"})," 文件中，避免分散。"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"类型安全"}),"：在 ",(0,r.jsx)(e.code,{children:"perform"})," 和控件参数中定义严格的参数类型 ",(0,r.jsx)(e.code,{children:"T"}),"，以确保开发时的自动补全与类型检查。"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"协议匹配"}),"：根据控件行为选择合适的 ",(0,r.jsx)(e.code,{children:"AppIntentProtocol"}),"，例如："]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["普通操作 → ",(0,r.jsx)(e.code,{children:"AppIntent"})]}),"\n",(0,r.jsxs)(e.li,{children:["控制音频播放 → ",(0,r.jsx)(e.code,{children:"AudioPlaybackIntent"})]}),"\n",(0,r.jsxs)(e.li,{children:["控制音频录制 → ",(0,r.jsx)(e.code,{children:"AudioRecordingIntent"}),"（iOS 18+ 且需保持 Live Activity）"]}),"\n",(0,r.jsxs)(e.li,{children:["启动/暂停 Live Activity → ",(0,r.jsx)(e.code,{children:"LiveActivityIntent"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"状态刷新"}),"：执行完 ",(0,r.jsx)(e.code,{children:"perform"})," 后，如需更新 UI 状态（例如切换门锁开关），请调用 ",(0,r.jsx)(e.code,{children:"ControlWidget.reloadButtons()"})," 、 ",(0,r.jsx)(e.code,{children:"ControlWidget.reloadToggles()"})," 或 ",(0,r.jsx)(e.code,{children:"Widget.reloadAll()"}),"。"]}),"\n"]}),"\n"]})]})}function l(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["TestFlight%2Fzh%2Fguide%2FAppIntent.md"]={toc:[{id:"一类型定义",text:"一、类型定义",depth:2},{id:"appintentt",text:"`AppIntent<T>`",depth:3},{id:"appintentfactoryt",text:"`AppIntentFactory<T>`",depth:3},{id:"appintentperformt",text:"`AppIntentPerform<T>`",depth:3},{id:"appintentprotocol",text:"`AppIntentProtocol`",depth:3},{id:"二appintentmanager-类",text:"二、AppIntentManager 类",depth:2},{id:"appintentmanagerregistertoptions-appintentfactoryt",text:"`AppIntentManager.register<T>(options): AppIntentFactory<T>`",depth:3},{id:"参数",text:"参数：",depth:4},{id:"返回值",text:"返回值：",depth:4},{id:"示例",text:"示例：",depth:4},{id:"三执行时环境",text:"三、执行时环境",depth:2},{id:"四最佳实践",text:"四、最佳实践",depth:2}],title:"AppIntent",headingTitle:"",frontmatter:{title:"AppIntent",description:"AppIntent 为小组件，灵动岛和控制中心的控件提供了执行脚本逻辑的核心机制。"}}}}]);